import{r as v,d as P,R as _}from"./app-BZXR5onu.js";function Y(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Y(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function F(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Y(t))&&(r&&(r+=" "),r+=e);return r}var z=v.createContext({}),X=()=>v.useContext(z),j=t=>_.createElement(z.Provider,{...t});function G(){let t=new Map;return{on(e,n){return t.has(e)?t.get(e).add(n):t.set(e,new Set([n])),this},off(e,n){return t.has(e)&&t.get(e).delete(n),this},emit(e,n){return t.has(e)&&t.get(e).forEach(r=>{r(n)}),this}}}var K=G(),J=()=>v.useRef(new Map).current,q=()=>{},I=["resize","contextmenu","click","scroll","blur"],O={show({event:t,id:e,props:n,position:r}){t.preventDefault&&t.preventDefault(),K.emit(0).emit(e,{event:t.nativeEvent||t,props:n,position:r})},hideAll(){K.emit(0)}};function re(t){return{show(e){O.show({...t,...e})},hideAll(){O.hideAll()}}}function Q(){let t=new Map,e,n,r,l,i=!1;function L(o){l=Array.from(o.values()),e=-1,r=!0}function p(){l[e].node.focus()}let h=()=>e>=0&&l[e].isSubmenu,R=()=>Array.from(l[e].submenuRefTracker.values());function u(){return e===-1?(b(),!1):!0}function b(){e+1<l.length?e++:e+1===l.length&&(e=0),i&&f(),p()}function x(){e===-1||e===0?e=l.length-1:e-1<l.length&&e--,i&&f(),p()}function g(){if(u()&&h()){let o=R(),{node:m,setSubmenuPosition:w}=l[e];return t.set(m,{isRoot:r,focusedIndex:e,parentNode:n||m,items:l}),w(),m.classList.add("contexify_submenu-isOpen"),n=m,o.length>0?(e=0,l=o):i=!0,r=!1,p(),!0}return!1}function f(){if(u()&&!r){let o=t.get(n);n.classList.remove("contexify_submenu-isOpen"),l=o.items,n=o.parentNode,o.isRoot&&(r=!0,t.clear()),i||(e=o.focusedIndex,p())}}function E(o){function m(w){for(let d of w)d.isSubmenu&&d.submenuRefTracker&&m(Array.from(d.submenuRefTracker.values())),d.keyMatcher&&d.keyMatcher(o)}m(l)}return{init:L,moveDown:b,moveUp:x,openSubmenu:g,closeSubmenu:f,matchKeys:E}}function $(t){return typeof t=="function"}function U(t){return typeof t=="string"}function Z(t,e){return v.Children.map(v.Children.toArray(t).filter(Boolean),n=>v.cloneElement(n,e))}function ee(t){let e={x:t.clientX,y:t.clientY},n=t.changedTouches;return n&&(e.x=n[0].clientX,e.y=n[0].clientY),(!e.x||e.x<0)&&(e.x=0),(!e.y||e.y<0)&&(e.y=0),e}function B(t,e){return $(t)?t(e):t}function te(t,e){return{...t,...$(e)?e(t):e}}var ie=({id:t,theme:e,style:n,className:r,children:l,animation:i="fade",preventDefaultOnKeydown:L=!0,disableBoundariesCheck:p=!1,onVisibilityChange:h,...R})=>{let[u,b]=v.useReducer(te,{x:0,y:0,visible:!1,triggerEvent:{},propsFromTrigger:null,willLeave:!1}),x=v.useRef(null),g=J(),[f]=v.useState(()=>Q()),E=v.useRef(),o=v.useRef();v.useEffect(()=>(K.on(t,w).on(0,d),()=>{K.off(t,w).off(0,d)}),[t,i,p]),v.useEffect(()=>{u.visible?f.init(g):g.clear()},[u.visible,f,g]);function m(a,y){if(x.current&&!p){let{innerWidth:c,innerHeight:T}=window,{offsetWidth:D,offsetHeight:M}=x.current;a+D>c&&(a-=a+D-c),y+M>T&&(y-=y+M-T)}return{x:a,y}}v.useEffect(()=>{u.visible&&b(m(u.x,u.y))},[u.visible]),v.useEffect(()=>{function a(c){L&&c.preventDefault()}function y(c){switch(c.key){case"Enter":case" ":f.openSubmenu()||d();break;case"Escape":d();break;case"ArrowUp":a(c),f.moveUp();break;case"ArrowDown":a(c),f.moveDown();break;case"ArrowRight":a(c),f.openSubmenu();break;case"ArrowLeft":a(c),f.closeSubmenu();break;default:f.matchKeys(c);break}}if(u.visible){window.addEventListener("keydown",y);for(let c of I)window.addEventListener(c,d)}return()=>{window.removeEventListener("keydown",y);for(let c of I)window.removeEventListener(c,d)}},[u.visible,f,L]);function w({event:a,props:y,position:c}){a.stopPropagation();let T=c||ee(a),{x:D,y:M}=m(T.x,T.y);P.flushSync(()=>{b({visible:!0,willLeave:!1,x:D,y:M,triggerEvent:a,propsFromTrigger:y})}),clearTimeout(o.current),!E.current&&$(h)&&(h(!0),E.current=!0)}function d(a){a!=null&&(a.button===2||a.ctrlKey)&&a.type!=="contextmenu"||(i&&(U(i)||"exit"in i&&i.exit)?b(y=>({willLeave:y.visible})):b(y=>({visible:y.visible?!1:y.visible})),o.current=setTimeout(()=>{$(h)&&h(!1),E.current=!1}))}function S(){u.willLeave&&u.visible&&P.flushSync(()=>b({visible:!1,willLeave:!1}))}function N(){return U(i)?F({[`contexify_willEnter-${i}`]:k&&!C,[`contexify_willLeave-${i} contexify_willLeave-'disabled'`]:k&&C}):i&&"enter"in i&&"exit"in i?F({[`contexify_willEnter-${i.enter}`]:i.enter&&k&&!C,[`contexify_willLeave-${i.exit} contexify_willLeave-'disabled'`]:i.exit&&k&&C}):null}let{visible:k,triggerEvent:s,propsFromTrigger:A,x:H,y:V,willLeave:C}=u,W=F("contexify",r,{[`contexify_theme-${e}`]:e},N());return _.createElement(j,{value:g},k&&_.createElement("div",{...R,className:W,onAnimationEnd:S,style:{...n,left:H,top:V,opacity:1},ref:x,role:"menu"},Z(l,{propsFromTrigger:A,triggerEvent:s})))},oe=({id:t,children:e,className:n,style:r,triggerEvent:l,data:i,propsFromTrigger:L,keyMatcher:p,onClick:h=q,disabled:R=!1,hidden:u=!1,closeOnClick:b=!0,handlerEvent:x="onClick",...g})=>{let f=v.useRef(),E=X(),o={id:t,data:i,triggerEvent:l,props:L},m=B(R,o),w=B(u,o);function d(s){o.event=s,s.stopPropagation(),m||(b?S():h(o))}function S(){let s=f.current;s.focus(),s.addEventListener("animationend",()=>setTimeout(O.hideAll),{once:!0}),s.classList.add("contexify_item-feedback"),h(o)}function N(s){s&&!m&&(f.current=s,E.set(s,{node:s,isSubmenu:!1,keyMatcher:!m&&$(p)&&(A=>{p(A)&&(A.stopPropagation(),A.preventDefault(),o.event=A,S())})}))}function k(s){(s.key==="Enter"||s.key===" ")&&(s.stopPropagation(),o.event=s,S())}return w?null:_.createElement("div",{...g,[x]:d,className:F("contexify_item",n,{"contexify_item-disabled":m}),style:r,onKeyDown:k,ref:N,tabIndex:-1,role:"menuitem","aria-disabled":m},_.createElement("div",{className:"contexify_itemContent"},e))};export{re as F,ie as i,oe as p};
