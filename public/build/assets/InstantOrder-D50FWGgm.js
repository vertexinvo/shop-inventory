import{r as d,j as t,Y as ut,y as m}from"./app-C6dVDm2D.js";import{F as bt,a as jt,b as c,E as r}from"./formik.esm-oZfdVZwT.js";import{M as gt,F as yt}from"./index-DO8EgVcX.js";import{A as ft}from"./AuthenticatedLayout-CAunjlKb.js";import{c as Nt,b as vt,a as h}from"./index.esm-D9-W15b-.js";import{S as ct}from"./react-select.esm-C3wBQZ1Y.js";import"./quill.snow-CKdPH4Dm.js";import{B as o}from"./ReactToastify-xooEvjAo.js";import"./transition-jWLo1_96.js";import"./Modal-eB3VJsfr.js";function zt(ot){const{auth:kt,users:g,order_id:mt,items:y}=ot,[ht,f]=d.useState(!1),[pt,N]=d.useState(!1),[a,p]=d.useState(null),[wt,_t]=d.useState(null),[St,Ct]=d.useState(!1);return t.jsxs(ft,{header:t.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Instant Order"}),children:[t.jsx(ut,{title:"Instant Order"}),t.jsx(bt,{enableReinitialize:!0,initialValues:{name:"",email:"",phone:"",address:"",total:0,payable_amount:0,paid_amount:0,discount:0,items:[]},validationSchema:Nt({name:h().required("Name is required"),email:h(),phone:h(),address:h(),items:vt().min(1,"At least one item is required")}),onSubmit:(u,{setSubmitting:e,resetForm:v})=>{console.log(u),m.post(route("order.instantorderstore"),u,{onSuccess:()=>{v()},preserveScroll:!0,preserveState:!0})},children:({isSubmitting:u,values:e,errors:v,setFieldValue:l})=>{var k,w,_,S,C,q,A,E,P,M,Q,L,T,$,O,z,B,R,D,G,W,Y,H,J,K,U,X,Z,F;return d.useEffect(()=>{const s=e.items.reduce((x,i)=>x+i.quantity*i.data.selling_price,0),n=parseFloat(e.discount||0);l("total",s),l("payable_amount",s-n)},[e.items,e.discount,l]),t.jsx(jt,{children:t.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[t.jsx("div",{className:`w-full ${e.items.length>0?"col-span-2":"col-span-3"}`,children:t.jsx("div",{className:"font-sans antialiased bg-grey-lightest",children:t.jsx("div",{className:"w-full bg-grey-lightest",children:t.jsx("div",{className:"container mx-auto py-3 px-5",children:t.jsxs("div",{className:"w-full lg:w-full mx-auto bg-white rounded shadow p-10",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"w-full flex items-center justify-between",children:[t.jsxs("label",{className:"block text-grey-darker text-lg font-bold mb-2",children:["Order #",mt]}),t.jsxs("div",{className:"flex items-center justify-start gap-1 ",children:[t.jsx("button",{className:"bg-black hover:bg-blue-dark text-white font-bold py-2 px-4 rounded-lg",type:"submit",children:"Submit"}),t.jsx("button",{onClick:()=>m.visit(route("order.index")),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg",type:"button",children:"Close"})]})]}),t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",for:"shop_name",children:"Select Customer (Existing)"}),t.jsx(ct,{onChange:s=>{l("user_id",s.value),l("name",s.name),l("email",s.email),l("phone",s.phone),l("address",s.address)},onInputChange:s=>{f(!0),setTimeout(()=>{m.get(route("order.instantorder"),{searchuser:s},{preserveScroll:!0,preserveState:!0}),f(!1)},1e3)},isSearchable:!0,isLoading:ht,value:g.find(s=>s.value===e.user_id),options:g,className:"basic-single",classNamePrefix:"select"})]}),t.jsxs("div",{className:"flex mb-4",children:[t.jsxs("div",{className:"w-1/2 mr-1",children:[t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",children:"Customer Name"}),t.jsx(c,{name:"name",className:"appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"text",placeholder:"Enter Customer name"}),t.jsx(r,{name:"name",component:"div",className:"text-red-500 text-xs mt-1"})]}),t.jsxs("div",{className:"w-1/2 mr-1",children:[t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",children:"Customer Email"}),t.jsx(c,{name:"email",className:"appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"text",placeholder:"Enter Customer email"}),t.jsx(r,{name:"email",component:"div",className:"text-red-500 text-xs mt-1"})]})]}),t.jsxs("div",{className:"flex mb-4",children:[t.jsxs("div",{className:"w-1/2 mr-1",children:[t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",children:"Customer Phone"}),t.jsx(c,{name:"phone",className:"appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"text",placeholder:"Enter Customer phone"}),t.jsx(r,{name:"phone",component:"div",className:"text-red-500 text-xs mt-1"})]}),t.jsxs("div",{className:"w-1/2 mr-1",children:[t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",children:"Customer Address"}),t.jsx(c,{name:"address",className:"appearance-none border rounded w-full py-2 px-3 text-grey-darker",type:"text",placeholder:"Enter Customer address"}),t.jsx(r,{name:"address",component:"div",className:"text-red-500 text-xs mt-1"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-grey-darker text-sm  mb-2",for:"shop_name",children:"Select Items"}),t.jsx(ct,{onChange:s=>{p(s)},onInputChange:s=>{N(!0),setTimeout(()=>{m.get(route("order.instantorder"),{searchitem:s},{preserveScroll:!0,preserveState:!0}),N(!1)},1e3)},isSearchable:!0,isLoading:pt,value:y.find(s=>s.value===(a==null?void 0:a.value)),options:y,className:"basic-single",classNamePrefix:"select"}),t.jsx(r,{name:"items",component:"div",className:"text-red-500 text-xs mt-1"})]}),a&&t.jsxs("div",{className:"flex  ",children:[t.jsx("div",{className:"w-1/2 mr-1",children:t.jsx("input",{type:"number",value:a==null?void 0:a.quantity,onChange:s=>p({...a,quantity:s.target.value}),placeholder:"Enter Quantity",className:"appearance-none border rounded w-full py-2 px-3 text-grey-darker"})}),t.jsx("div",{className:"w-1/2 mr-1",children:t.jsx("button",{onClick:()=>{var s,n;if((a==null?void 0:a.quantity)>((n=(s=a==null?void 0:a.data)==null?void 0:s.stock)==null?void 0:n.quantity)){o.error("Quantity exceeds stock quantity");return}if(e.items.find(x=>{var i;return x.data.id===((i=a==null?void 0:a.data)==null?void 0:i.id)})){o.error("Item already added");return}if((a==null?void 0:a.quantity)<=0){o.error("Quantity must be greater than 0");return}p(null),l("items",[...e.items,a]),console.log(e.items)},className:"bg-black text-sm hover:bg-blue-dark text-white font-bold py-[11px] px-4  rounded-lg",type:"button",children:"Add Item"})})]}),a&&t.jsx("div",{className:"my-5",children:t.jsx("div",{className:"",children:t.jsx("div",{class:"font-[sans-serif] ",children:t.jsx("table",{class:"min-w-full bg-white",children:t.jsxs("thead",{class:"whitespace-nowrap",children:[t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Product Info"}),t.jsx("td",{class:" text-sm",children:t.jsx("div",{class:"flex items-center cursor-pointer w-max",children:t.jsxs("div",{class:"ml-4 ",children:[t.jsxs("p",{class:"text-sm text-black ",children:["Name : ",(k=a==null?void 0:a.data)==null?void 0:k.name]}),((w=a==null?void 0:a.data)==null?void 0:w.model)&&t.jsxs("p",{class:"text-xs text-gray-500 mt-0.5",children:["Model :",(_=a==null?void 0:a.data)==null?void 0:_.model," "]}),((S=a==null?void 0:a.data)==null?void 0:S.identity_type)!=="none"&&t.jsxs("p",{class:"text-xs text-gray-500 mt-0.5",children:[(C=a==null?void 0:a.data)==null?void 0:C.identity_type,":",(q=a==null?void 0:a.data)==null?void 0:q.identity_value," "]})]})})})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Purchase price"}),t.jsx("td",{class:"p-4 text-sm text-black",children:((A=a==null?void 0:a.data)==null?void 0:A.purchase_price)||"N/A"})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Selling price"}),t.jsx("td",{class:"p-4 text-sm text-black",children:((E=a==null?void 0:a.data)==null?void 0:E.selling_price)||"N/A"})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Warranty period"}),t.jsxs("td",{class:"p-4 text-sm text-black",children:[((P=a==null?void 0:a.data)==null?void 0:P.is_warranty)=="0"&&t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:"No"}),((M=a==null?void 0:a.data)==null?void 0:M.is_warranty)=="1"&&t.jsxs("p",{class:"text-xs text-gray-500 mt-0.5",children:[(Q=a==null?void 0:a.data)==null?void 0:Q.warranty_period," - ",(L=a==null?void 0:a.data)==null?void 0:L.warranty_type," "]})]})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Is Borrow"}),t.jsxs("td",{class:"p-4 text-sm text-black",children:[((T=a==null?void 0:a.data)==null?void 0:T.is_borrow)=="0"&&t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:"No"}),(($=a==null?void 0:a.data)==null?void 0:$.is_borrow)=="1"&&t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:t.jsxs("ul",{class:"list-disc",children:[((O=a==null?void 0:a.data)==null?void 0:O.shop_name)&&t.jsxs("li",{children:["Name: ",(z=a==null?void 0:a.data)==null?void 0:z.shop_name]}),((B=a==null?void 0:a.data)==null?void 0:B.shop_address)&&t.jsxs("li",{children:["Address: ",(R=a==null?void 0:a.data)==null?void 0:R.shop_address]}),((D=a==null?void 0:a.data)==null?void 0:D.shop_phone)&&t.jsxs("li",{children:["Phone: ",(G=a==null?void 0:a.data)==null?void 0:G.shop_phone]}),((W=a==null?void 0:a.data)==null?void 0:W.shop_email)&&t.jsxs("li",{children:["Email: ",(Y=a==null?void 0:a.data)==null?void 0:Y.shop_email]})]})})]})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Stock  Quantity"}),t.jsx("td",{class:"p-4 text-sm text-black",children:((J=(H=a==null?void 0:a.data)==null?void 0:H.stock)==null?void 0:J.quantity)||0})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Stock Status"}),t.jsx("td",{class:"p-4",children:(U=(K=a==null?void 0:a.data)==null?void 0:K.stock)!=null&&U.status?t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:"Available"}):t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:"Not Available"})})]}),t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Supplier Invoice"}),t.jsxs("td",{class:"p-4 text-sm text-black",children:[((X=a==null?void 0:a.data)==null?void 0:X.is_supplier)=="0"&&t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:"No"}),((Z=a==null?void 0:a.data)==null?void 0:Z.is_supplier)=="1"&&t.jsx("p",{class:"text-xs text-gray-500 mt-0.5",children:(F=a==null?void 0:a.data)==null?void 0:F.supplier_invoice_no})]})]})]})})})})})]})})})})}),e.items.length>0&&t.jsxs("div",{className:"w-full col-span-1",children:[t.jsx("div",{className:"font-sans antialiased bg-grey-lightest",children:t.jsx("div",{className:"w-full bg-grey-lightest",children:t.jsx("div",{className:"container mx-auto py-3 px-5",children:t.jsx("div",{className:"w-full lg:w-full mx-auto bg-white rounded shadow p-10",children:e.items.length>0&&t.jsxs("div",{className:"mb-2",children:[t.jsxs("div",{className:"w-full flex items-center justify-between mb-2",children:[t.jsx("label",{className:"block text-grey-darker text-lg font-bold ",children:"Cart"}),t.jsx(gt,{size:25,onClick:()=>l("items",[])})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsx("div",{class:"font-[sans-serif] overflow-x-auto",children:t.jsxs("table",{class:"min-w-full bg-white",children:[t.jsx("thead",{class:"whitespace-nowrap",children:t.jsxs("tr",{children:[t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Product Info"}),t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"price"}),t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Qty"}),t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black",children:"Total"}),t.jsx("th",{class:"p-4 text-left text-sm font-semibold text-black"})]})}),t.jsx("tbody",{class:"whitespace-nowrap",children:e.items.map((s,n)=>{var x,i,V,I,tt,at,st,et,lt,nt;return t.jsxs("tr",{class:"odd:bg-gray-50",children:[t.jsx("td",{class:" text-sm",children:t.jsx("div",{class:"flex items-center cursor-pointer w-max",children:t.jsxs("div",{class:"ml-4 ",children:[t.jsxs("p",{class:"text-sm text-black ",children:["Name : ",(x=s==null?void 0:s.data)==null?void 0:x.name]}),((i=s==null?void 0:s.data)==null?void 0:i.model)&&t.jsxs("p",{class:"text-xs text-gray-500 mt-0.5",children:["Model :",(V=s==null?void 0:s.data)==null?void 0:V.model," "]}),((I=s==null?void 0:s.data)==null?void 0:I.identity_type)!=="none"&&t.jsxs("p",{class:"text-xs text-gray-500 mt-0.5",children:[(tt=s==null?void 0:s.data)==null?void 0:tt.identity_type,":",(at=s==null?void 0:s.data)==null?void 0:at.identity_value," "]})]})})}),t.jsx("td",{class:"p-4 text-sm text-black",children:((st=s==null?void 0:s.data)==null?void 0:st.selling_price)||"N/A"}),t.jsx("td",{class:"p-4 text-sm text-black",children:t.jsx("input",{type:"number",name:"quantity",value:s==null?void 0:s.quantity,className:"appearance-none border rounded w-[60px] py-2 px-3 text-grey-darker",max:((lt=(et=s==null?void 0:s.data)==null?void 0:et.stock)==null?void 0:lt.quantity)||0,onChange:b=>{var it,rt,xt,dt;const j=Number(b.target.value);if(j>((rt=(it=s==null?void 0:s.data)==null?void 0:it.stock)==null?void 0:rt.quantity)){o.error("Quantity exceeds stock quantity");return}if(j<=0){o.error("Quantity must be greater than 0");return}l(`items.${n}.quantity`,Math.min(j,((dt=(xt=s==null?void 0:s.data)==null?void 0:xt.stock)==null?void 0:dt.quantity)||0))}})}),t.jsx("td",{class:"p-4 text-sm text-black",children:(s==null?void 0:s.quantity)*((nt=s==null?void 0:s.data)==null?void 0:nt.selling_price)||0}),t.jsx("td",{class:"p-4 text-sm text-black",children:t.jsx(yt,{color:"red",className:"cursor-pointer hover:scale-110",onClick:()=>{l("items",e.items.filter(b=>b.data.id!==s.data.id))}})})]})})})]})})})]})})})})}),t.jsx("div",{className:"font-sans antialiased bg-grey-lightest",children:t.jsx("div",{className:"w-full bg-grey-lightest",children:t.jsx("div",{className:"container mx-auto py-3 px-5",children:t.jsx("div",{className:"w-full lg:w-full mx-auto bg-white rounded shadow p-10",children:e.items.length>0&&t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"w-full flex items-center justify-between mb-2",children:t.jsx("label",{className:"block text-grey-darker text-lg font-bold ",children:"Calculation"})}),t.jsxs("ul",{className:"mt-5",children:[t.jsxs("li",{className:"w-full flex items-center justify-between mb-2",children:[t.jsx("div",{children:"Total Amount:"}),t.jsx("div",{children:t.jsx("input",{type:"number",value:e.items.reduce((s,n)=>s+n.quantity*n.data.selling_price,0),className:"appearance-none border rounded disabled:bg-gray-200 disabled:hover:bg-gray-200	 py-2 px-3 text-grey-darker",disabled:!0})})]}),t.jsx("li",{className:"w-full flex items-center justify-between mb-2",children:t.jsx(r,{name:"extra_charges",component:"div",className:"text-red-600 text-xs mt-1"})}),t.jsxs("li",{className:"w-full flex items-center justify-between",children:[t.jsx("div",{children:"Discount:"}),t.jsxs("div",{children:[" ",t.jsx(c,{type:"number",name:"discount",value:e.discount,className:"appearance-none border rounded 	 py-2 px-3 text-grey-darker"})]})]}),t.jsx("li",{className:"w-full flex items-center justify-between mb-2",children:t.jsx(r,{name:"discount",component:"div",className:"text-red-600 text-xs mt-1"})}),t.jsxs("li",{className:"w-full flex items-center justify-between mb-2",children:[t.jsx("div",{className:"font-bold",children:"Grand Total:"}),t.jsx("div",{children:t.jsx("input",{type:"number",value:e.items.reduce((s,n)=>s+n.quantity*n.data.selling_price,0)-parseFloat(e.discount||0),className:"appearance-none border rounded disabled:bg-gray-200 disabled:hover:bg-gray-200 py-2 px-3 text-grey-darker",disabled:!0})})]}),t.jsxs("li",{className:"w-full flex items-center justify-between",children:[t.jsx("div",{children:"Paid Amount:"}),t.jsx("div",{children:t.jsx(c,{type:"number",name:"paid_amount",value:e.paid_amount||e.payable_amount||0,onChange:s=>l("paid_amount",s.target.value),className:"appearance-none border rounded py-2 px-3 text-grey-darker"})})]})]})]})})})})})]})]})})}})]})}export{zt as default};
